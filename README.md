# PS-SentinelOne PowerShell Module


## Table of Contents

* [Overview](#overview)
* [Installation and Removal](#installation-and-removal)
* [Configuration](#configuration)
* [Capability](#capability)

----------
## Overview

This is a PowerShell script module that provides command-line interaction and automation for the SentinelOne REST API.

----------
## Installation and Removal

Installation of this module currently consists of a pair of scripts that will copy the module to one of the PowerShell module paths, and check PowerShell module paths to remove it.

**Install**
```PowerShell
.\Install-Module.ps1
```

**Uninstall**
```PowerShell
.\Uninstall-Module.ps1
```

----------
## Configuration

PS-SentinelOne requires a few additional configuration steps to perform before use.

Save your management console URL in the locally cached configuration to be used in queries.
```PowerShell
Set-S1ModuleConfiguration -URI "https://management-tenant.sentinelone.net"
```

A long-term API token can be generated in your management console by using the **My User** menu to create an API token. Use the following command to convert that token to a secure string and serialize it to disk.
```PowerShell
Set-S1ModuleConfiguration -ApiToken "<token here>"
```

A short-term token can be generated by authenticating to the API with your SentinelOne username and password. Use the following command to prompt you for your credentials, then cache the returned token to disk.
```PowerShell
Get-S1Token -Credentials (Get-Credential)
```
----------
## Capability

Development is ongoing, with the goal to add support for the majority of the API set.

- [ ] Accounts
-  [*] Get Accounts
-  [ ] Create Account
- [ ] Sites
-  [ ] Get Sites
-  [ ] Create Site
-  [ ] Delete Site
-  [ ] Update Site
-  [ ] Expire Site
-  [ ] Reactivate Site
- [ ] Groups
-  [ ] Get Groups
-  [ ] Create Group
-  [ ] Delete Group
-  [ ] Set Policy for Group
-  [ ] Revert Policy for Group
- [ ] Policy
-  [ ] Get Policy
-  [ ] Set Policy
-  [ ] Revert Policy
- [ ] Activities
-  [ ] Get Activity Types
-  [ ] Get Activities
- [ ] Agents
-  [*] Get Agents
-  [ ] Get Available Actions
-  [ ] Get Firewall Rules
-  [ ] Get Passphrase
-  [ ] Start Scan
-  [ ] Abort Scan
-  [ ] Fetch Logs
-  [ ] Fetch File
-  [ ] Disconnect from Network
-  [ ] Reconnect to Network
-  [ ] Send a Message
-  [ ] Initiate Uninstall
-  [ ] Move to Site
-  [ ] Move to Group
-  [ ] Count by Filters
-  [ ] Count Summary
-  [ ] Count
- [ ] Get Hash Reputation
- [ ] Exclusions
-  [ ] Whitelist
-   [ ] Get Whitelist
-   [ ] Add to Whitelist
-   [ ] Update Whitelist
-   [ ] Delete from Whitelist
-  [ ] Blacklist
-   [ ] Get Blacklist
-   [ ] Add to Blacklist
-   [ ] Update Blacklist
-   [ ] Delete from Blacklist
- [ ] Applications
-  [ ] Get Applications
-  [ ] Get CVEs
-  [ ] Get Application CVEs
- [ ] Threats
-  [ ] Get Threat Summary
-  [ ] Get Threats
-  [ ] Get Grouped Threats
-  [ ] Get Threat Forensic Details
-  [ ] Get Threat Network Connections
-  [ ] Get Static Indicators
-  [ ] Fetch File
-  [ ] Get Threat Available Actions
-  [ ] Get Whitening Options
-  [ ] Mitigate Threat
-  [ ] Mark as Unresolved
-  [ ] Mark as Resolved 
-  [ ] Add to Blacklist
-  [ ] Mark as Benign
-  [ ] Mark as Threat
-  [ ] Update Threat
- [ ] Deep Visibility
-  [ ] Filters
-   [ ] Get Saved Filters
-   [ ] Save Filter
-   [ ] Update Filter
-   [ ] Delete Filter
-  [ ] Get Query Status
-  [ ] Create Query and Get Query ID
-  [ ] Get Events
-  [ ] Get Events by Type